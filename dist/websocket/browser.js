!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["hyperactiv-websocket"]=t()}(this,(function(){"use strict";const e=function(e){return Number.isInteger(Number.parseInt(e,10))?[]:{}};return(t,r,n,s)=>{const o={},i=new WebSocket(t||"ws://localhost:8080"),a=function(t){if(!t)throw new Error("writeHandler needs a proper target !");return function(r,n){n="object"==typeof n?JSON.parse(JSON.stringify(n)):n;for(let n=0;n<r.length-1;n++){var s=r[n];void 0===t[s]&&(t[s]=e(r[n+1])),t=t[s]}t[r[r.length-1]]=n}}(r);let d=0;i.addEventListener("message",(e=>{e=JSON.parse(e.data),n&&n(e),"sync"===e.type?(Object.assign(r,e.state),Array.isArray(e.methods)&&e.methods.forEach((e=>a(e,(async(...t)=>(i.send(JSON.stringify({type:"call",keys:e,args:t,request:++d})),new Promise(((t,r)=>{o[d]={resolve:t,reject:r},setTimeout((()=>{delete o[d],r(new Error("Timeout on call to "+e))}),s||15e3)})))))))):"update"===e.type?a(e.keys,e.value):"response"===e.type&&(e.error?o[e.request].reject(e.error):o[e.request].resolve(e.result),delete o[e.request])})),i.addEventListener("open",(()=>i.send("sync")))}}));
//# sourceMappingURL=browser.js.map
