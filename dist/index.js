!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).hyperactiv=t()}(this,(function(){"use strict";const e=["String","Number","Object","Array","Boolean","Date"];function t(e){return e&&"object"==typeof e}function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,configurable:!0})}function r(e,t,r){n(e,"__key",t),n(e,"__parent",r)}const o={computedStack:[],trackerSymbol:Symbol("tracker")};let i=null;const f=Symbol();function a(){if(i){for(const e of i)e(),e[f]=!1;i=null}}function c(e,t){e[f]||(null===i&&(i=[],!0===t?queueMicrotask(a):setTimeout(a,t)),i.push(e))}const{computedStack:u,trackerSymbol:s}=o,l=Symbol("__observed"),d=Symbol("modifiedProperty");const{computedStack:y,trackerSymbol:b}=o;var p={observe:function o(i,a={}){const{props:y,ignore:b,batch:p,deep:h=!0,bubble:g,bind:m}=a;if(i[l])return i;const _=e=>e!==l&&(null==y||y instanceof Array&&y.includes(e))&&(null==b||b instanceof Array&&!b.includes(e));function O(e,i,l){if("__handler"===i)n(e,"__handler",l);else if(_(i)){if(Array.isArray(e)&&"length"===i||function(e,t,n){const r=new Map;function o(e,t,n){if(e===t)return!1;let i=typeof e;if(i!==typeof t)return!0;function f(e,t,n){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;if(r.has(e)||r.has(t)){if(r.has(e)&&r.get(e).has(t))return!1;if(r.has(t)&&r.get(t).has(e))return!1;r.has(e)||r.set(e,new Set),r.get(e).add(t)}for(let r=0,i=e.length;r<i;r++)if(o(e[r],t[r],n))return!0;return!1}function a(e,t,n="by-value"){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(let n in e)if(!(n in t))return!0;for(let n in t)if(!(n in e))return!0;if(r.has(e)||r.has(t)){if(r.has(e)&&r.get(e).has(t))return!1;if(r.has(t)&&r.get(t).has(e))return!1;r.has(e)||r.set(e,new Set),r.get(e).add(t)}for(let r in e)if(o(e[r],t[r],n))return!0;return!1}switch(i){case"undefined":case"boolean":case"string":case"function":default:return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||("by-value"===n&&(e instanceof Boolean||e instanceof Number||e instanceof String)?e.valueOf()!==t.valueOf():Array.isArray(e)?f(e,t,n):"by-reference"===n||a(e,t,n)))}return!0}return o(e,t,n)}(e[i],l)){const n=i!==d&&h&&t(l),y=e[i];e[i]=n?o(l,a):l,n&&g&&r(e[i],i,e);const b=[i];let m=e;for(;m&&(!m.__handler||!1!==m.__handler(b,l,y,P));)m.__key&&m.__parent?(b.unshift(m.__key),m=m.__parent):m=null;const _=S.get(i);if(_)for(const t of _){const n=t[s],r=n&&n.get(e),o=r&&r.has(i);t.__disposed||n&&!o?_.delete(t):t!==u[0]&&(void 0!==p&&!1!==p?(c(t,p),t[f]=!0):t())}if(i!==d){e[d]=i;const t=S.get(d);if(t)for(const n of t){const r=n[s],o=r&&r.get(e),i=o&&o.has(d);n.__disposed||r&&!i?t.delete(n):n!==u[0]&&(void 0!==p&&!1!==p?(c(n,p),n[f]=!0):n())}}}}else e[i]=l}h&&Object.entries(i).forEach((function([e,n]){t(n)&&_(e)&&(i[e]=o(n,a),g&&r(i[e],e,i))}));const S=new Map,P=new Proxy(i,{get(e,t){if(t===l)return!0;if(_(t)&&u.length){const e=u[0],n=e[s];if(n){let e=n.get(i);e||(e=new Set,n.set(i,e)),e.add(t)}let r=S.get(t);r||(r=new Set,S.set(t,r)),r.add(e)}return i[t]},set:(e,t,n)=>(O(i,t,n),!0),defineProperty(e,n,r){if("__handler"===n)throw new Error("Don't track bubble handlers");if(!_(n))return Reflect.defineProperty(i,n,r);if(!Array.isArray(i)||"length"===n){"value"in r&&h&&t(r.value)&&((r={...r}).value=o(r.value,a));const e=Reflect.defineProperty(i,n,r);return n!==d&&(i[d]=n),e}return!1},deleteProperty(e,t){if(t===d)throw new Error('internal property Symbol("modifiedProperty") must not be deleted');return t in i&&O(i,t,void 0),Reflect.deleteProperty(e,t)}});var v;return m&&(v=i,Object.getOwnPropertyNames(v).concat(Object.getPrototypeOf(v)&&e.indexOf(Object.getPrototypeOf(v).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(v)):[]).filter((e=>"constructor"!==e&&"function"==typeof v[e]))).forEach((e=>i[e]=i[e].bind(P))),P},modifiedProperty:d,computed:function(e,{autoRun:t=!0,callback:n,bind:r,disableTracking:o=!1}={}){function i(t,i=[]){const c=n||a;o||(c[b]=new WeakMap),y.unshift(c),i=i.length>0?[...i,f]:[f];const u=t?t():r?e.apply(r,i):e(...i);return y.shift(),u}const f={computeAsync:i},a=(...e)=>i(null,e);return t&&a(),a},dispose:function(e){return e[o.trackerSymbol]=null,e.__disposed=!0},batch:a};return p}));
//# sourceMappingURL=index.js.map
