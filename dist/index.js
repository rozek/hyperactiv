!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).hyperactiv=t()}(this,(function(){"use strict";const e=["String","Number","Object","Array","Boolean","Date"];function t(e){return e&&"object"==typeof e}function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,configurable:!0})}function r(e,t,r){n(e,"__key",t),n(e,"__parent",r)}const o={computedStack:[],trackerSymbol:Symbol("tracker")};let i=null;const c=Symbol();function f(){if(i){for(const e of i)e(),e[c]=!1;i=null}}function u(e,t){e[c]||(null===i&&(i=[],!0===t?queueMicrotask(f):setTimeout(f,t)),i.push(e))}const{computedStack:l,trackerSymbol:a}=o,s=Symbol("__observed"),d=Symbol("modifiedProperty");function y(e,t,n){if(e===t)return!1;let r=typeof e;if(r!==typeof t)return!0;switch(r){case"undefined":case"boolean":case"string":case"function":default:return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||("by-value"===n&&(e instanceof Boolean||e instanceof Number||e instanceof String)?e.valueOf()!==t.valueOf():Array.isArray(e)?function(e,t,n){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;for(let r=0,o=e.length;r<o;r++)if(y(e[r],t[r],n))return!0;return!1}(e,t,n):"by-reference"===n||function(e,t,n){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(let n in e)if(!(n in t))return!0;for(let r in t){if(!(r in e))return!0;if(y(e[r],t[r],n))return!0}return!1}(e,t,n)))}return!0}const{computedStack:b,trackerSymbol:p}=o;var h={observe:function o(i,f={}){const{props:b,ignore:p,batch:h,deep:m=!0,bubble:_,bind:g}=f;if(i[s])return i;const O=e=>e!==s&&(null==b||b instanceof Array&&b.includes(e))&&(null==p||p instanceof Array&&!p.includes(e));function P(e,i,s){if("__handler"===i)n(e,"__handler",s);else if(O(i)){if(Array.isArray(e)&&"length"===i||y(e[i],s)){const n=i!==d&&m&&t(s),y=e[i];e[i]=n?o(s,f):s,n&&_&&r(e[i],i,e);const b=[i];let p=e;for(;p&&(!p.__handler||!1!==p.__handler(b,s,y,k));)p.__key&&p.__parent?(b.unshift(p.__key),p=p.__parent):p=null;const g=S.get(i);if(g)for(const t of g){const n=t[a],r=n&&n.get(e),o=r&&r.has(i);t.__disposed||n&&!o?g.delete(t):t!==l[0]&&(void 0!==h&&!1!==h?(u(t,h),t[c]=!0):t())}if(i!==d){e[d]=i;const t=S.get(d);if(t)for(const n of t){const r=n[a],o=r&&r.get(e),i=o&&o.has(d);n.__disposed||r&&!i?t.delete(n):n!==l[0]&&(void 0!==h&&!1!==h?(u(n,h),n[c]=!0):n())}}}}else e[i]=s}m&&Object.entries(i).forEach((function([e,n]){t(n)&&O(e)&&(i[e]=o(n,f),_&&r(i[e],e,i))}));const S=new Map,k=new Proxy(i,{get(e,t){if(t===s)return!0;if(O(t)&&l.length){const e=l[0],n=e[a];if(n){let e=n.get(i);e||(e=new Set,n.set(i,e)),e.add(t)}let r=S.get(t);r||(r=new Set,S.set(t,r)),r.add(e)}return i[t]},set:(e,t,n)=>(P(i,t,n),!0),defineProperty(e,n,r){if("__handler"===n)throw new Error("Don't track bubble handlers");if(!O(n))return Reflect.defineProperty(i,n,r);if(!Array.isArray(i)||"length"===n){"value"in r&&m&&t(r.value)&&((r={...r}).value=o(r.value,f));const e=Reflect.defineProperty(i,n,r);return n!==d&&(i[d]=n),e}return!1},deleteProperty(e,t){if(t===d)throw new Error('internal property Symbol("modifiedProperty") must not be deleted');return t in i&&P(i,t,void 0),Reflect.deleteProperty(e,t)}});var v;return g&&(v=i,Object.getOwnPropertyNames(v).concat(Object.getPrototypeOf(v)&&e.indexOf(Object.getPrototypeOf(v).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(v)):[]).filter((e=>"constructor"!==e&&"function"==typeof v[e]))).forEach((e=>i[e]=i[e].bind(k))),k},modifiedProperty:d,computed:function(e,{autoRun:t=!0,callback:n,bind:r,disableTracking:o=!1}={}){function i(t,i=[]){const u=n||f;o||(u[p]=new WeakMap),b.unshift(u),i=i.length>0?[...i,c]:[c];const l=t?t():r?e.apply(r,i):e(...i);return b.shift(),l}const c={computeAsync:i},f=(...e)=>i(null,e);return t&&f(),f},dispose:function(e){return e[o.trackerSymbol]=null,e.__disposed=!0},batch:f};return h}));
//# sourceMappingURL=index.js.map
