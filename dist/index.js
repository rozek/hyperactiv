!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).hyperactiv=t()}(this,(function(){"use strict";const e=["String","Number","Object","Array","Boolean","Date"];function t(e){return e&&"object"==typeof e}function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,configurable:!0})}function r(e,t,r){n(e,"__key",t),n(e,"__parent",r)}const o={computedStack:[],trackerSymbol:Symbol("tracker")};let c=null;const i=Symbol();function u(){if(c){for(const e of c)e(),e[i]=!1;c=null}}function f(e,t){e[i]||(null===c&&(c=[],!0===t?queueMicrotask(u):setTimeout(u,t)),c.push(e))}const{computedStack:a,trackerSymbol:l}=o,s=Symbol("__observed");function d(e,t,n){if(e===t)return!1;let r=typeof e;if(r!==typeof t)return!0;switch(r){case"undefined":case"boolean":case"string":case"function":default:return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||("by-value"===n&&(e instanceof Boolean||e instanceof Number||e instanceof String)?e.valueOf()!==t.valueOf():Array.isArray(e)?function(e,t,n){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;for(let r=0,o=e.length;r<o;r++)if(d(e[r],t[r],n))return!0;return!1}(e,t,n):"by-reference"===n||function(e,t,n){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(let n in e)if(!(n in t))return!0;for(let r in t){if(!(r in e))return!0;if(d(e[r],t[r],n))return!0}return!1}(e,t,n)))}return!0}const{computedStack:y,trackerSymbol:b}=o;var p={observe:function o(c,u={}){const{props:y,ignore:b,batch:p,deep:h=!0,bubble:_,bind:g}=u;if(c[s])return c;const m=e=>e!==s&&(null==y||y instanceof Array&&y.includes(e))&&(null==b||b instanceof Array&&!b.includes(e));h&&Object.entries(c).forEach((function([e,n]){t(n)&&m(e)&&(c[e]=o(n,u),_&&r(c[e],e,c))}));const O=new Map,k=new Proxy(c,{get(e,t){if(t===s)return!0;if(m(t)&&a.length){const e=a[0],n=e[l];if(n){let e=n.get(c);e||(e=new Set,n.set(c,e)),e.add(t)}let r=O.get(t);r||(r=new Set,O.set(t,r)),r.add(e)}return c[t]},set(e,s,y){if("__handler"===s)n(c,"__handler",y);else if(m(s)){if(Array.isArray(c)&&"length"===s||d(c[s],y)){const e=h&&t(y),n=c[s];c[s]=e?o(y,u):y,e&&_&&r(c[s],s,c);const d=[s];let b=c;for(;b&&(!b.__handler||!1!==b.__handler(d,y,n,k));)b.__key&&b.__parent?(d.unshift(b.__key),b=b.__parent):b=null;const g=O.get(s);if(g)for(const e of g){const t=e[l],n=t&&t.get(c),r=n&&n.has(s);e.__disposed||t&&!r?g.delete(e):e!==a[0]&&(void 0!==p&&!1!==p?(f(e,p),e[i]=!0):e())}}}else c[s]=y;return!0},defineProperty(e,t,n){if("__handler"===t)throw new Error("Don't track bubble handlers");return m(t)?(!Array.isArray(c)||"length"===t)&&("value"in n&&((n={...n}).value=o(value,u)),Reflect.defineProperty(c,t,n)):Reflect.defineProperty(c,t,n)},deleteProperty:(e,t)=>(t in c&&(c[t]=void 0),Reflect.deleteProperty(e,t))});var P;return g&&(P=c,Object.getOwnPropertyNames(P).concat(Object.getPrototypeOf(P)&&e.indexOf(Object.getPrototypeOf(P).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(P)):[]).filter((e=>"constructor"!==e&&"function"==typeof P[e]))).forEach((e=>c[e]=c[e].bind(k))),k},computed:function(e,{autoRun:t=!0,callback:n,bind:r,disableTracking:o=!1}={}){function c(t,c=[]){const f=n||u;o||(f[b]=new WeakMap),y.unshift(f),c=c.length>0?[...c,i]:[i];const a=t?t():r?e.apply(r,c):e(...c);return y.shift(),a}const i={computeAsync:c},u=(...e)=>c(null,e);return t&&u(),u},dispose:function(e){return e[o.trackerSymbol]=null,e.__disposed=!0},batch:u};return p}));
//# sourceMappingURL=index.js.map
