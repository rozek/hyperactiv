const e=["String","Number","Object","Array","Boolean","Date"];function t(e){return e&&"object"==typeof e}function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,configurable:!0})}function r(e,t,r){n(e,"__key",t),n(e,"__parent",r)}const o={computedStack:[],trackerSymbol:Symbol("tracker")};let i=null;const a=Symbol();function c(){if(i){for(const e of i)e(),e[a]=!1;i=null}}function u(e,t){e[a]||(null===i&&(i=[],!0===t?queueMicrotask(c):setTimeout(c,t)),i.push(e))}const{computedStack:f,trackerSymbol:s}=o,l=Symbol("__observed"),d=Symbol("modifiedProperty");const{computedStack:y,trackerSymbol:b}=o;var p={observe:function o(i,c={}){const{props:y,ignore:b,batch:p,deep:h=!0,bubble:g,bind:_}=c;if(i[l])return i;const m=e=>e!==l&&(null==y||y instanceof Array&&y.includes(e))&&(null==b||b instanceof Array&&!b.includes(e));function O(e,i,l){if("__handler"===i)n(e,"__handler",l);else if(m(i)){if(Array.isArray(e)&&"length"===i||function(e,t,n){const r=new Map;function o(e,t,n){if(e===t)return!1;let i=typeof e;if(i!==typeof t)return!0;function a(e,t,n){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;if(r.has(e)||r.has(t)){if(r.has(e)&&r.get(e).has(t))return!1;if(r.has(t)&&r.get(t).has(e))return!1;r.has(e)||r.set(e,new Set),r.get(e).add(t)}for(let r=0,i=e.length;r<i;r++)if(o(e[r],t[r],n))return!0;return!1}function c(e,t,n="by-value"){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(let n in e)if(!(n in t))return!0;for(let n in t)if(!(n in e))return!0;if(r.has(e)||r.has(t)){if(r.has(e)&&r.get(e).has(t))return!1;if(r.has(t)&&r.get(t).has(e))return!1;r.has(e)||r.set(e,new Set),r.get(e).add(t)}for(let r in e)if(o(e[r],t[r],n))return!0;return!1}switch(i){case"undefined":case"boolean":case"string":case"function":default:return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||("by-value"===n&&(e instanceof Boolean||e instanceof Number||e instanceof String)?e.valueOf()!==t.valueOf():Array.isArray(e)?a(e,t,n):"by-reference"===n||c(e,t,n)))}return!0}return o(e,t,n)}(e[i],l)){const n=i!==d&&h&&t(l),y=e[i];e[i]=n?o(l,c):l,n&&g&&r(e[i],i,e);const b=[i];let _=e;for(;_&&(!_.__handler||!1!==_.__handler(b,l,y,P));)_.__key&&_.__parent?(b.unshift(_.__key),_=_.__parent):_=null;const m=S.get(i);if(m)for(const t of m){const n=t[s],r=n&&n.get(e),o=r&&r.has(i);t.__disposed||n&&!o?m.delete(t):t!==f[0]&&(void 0!==p&&!1!==p?(u(t,p),t[a]=!0):t())}if(i!==d){e[d]=i;const t=S.get(d);if(t)for(const n of t){const r=n[s],o=r&&r.get(e),i=o&&o.has(d);n.__disposed||r&&!i?t.delete(n):n!==f[0]&&(void 0!==p&&!1!==p?(u(n,p),n[a]=!0):n())}}}}else e[i]=l}h&&Object.entries(i).forEach((function([e,n]){t(n)&&m(e)&&(i[e]=o(n,c),g&&r(i[e],e,i))}));const S=new Map,P=new Proxy(i,{get(e,t){if(t===l)return!0;if(m(t)&&f.length){const e=f[0],n=e[s];if(n){let e=n.get(i);e||(e=new Set,n.set(i,e)),e.add(t)}let r=S.get(t);r||(r=new Set,S.set(t,r)),r.add(e)}return i[t]},set:(e,t,n)=>(O(i,t,n),!0),defineProperty(e,n,r){if("__handler"===n)throw new Error("Don't track bubble handlers");if(!m(n))return Reflect.defineProperty(i,n,r);if(!Array.isArray(i)||"length"===n){"value"in r&&h&&t(r.value)&&((r={...r}).value=o(r.value,c));const e=Reflect.defineProperty(i,n,r);return n!==d&&(i[d]=n),e}return!1},deleteProperty(e,t){if(t===d)throw new Error('internal property Symbol("modifiedProperty") must not be deleted');return t in i&&O(i,t,void 0),Reflect.deleteProperty(e,t)}});var k;return _&&(k=i,Object.getOwnPropertyNames(k).concat(Object.getPrototypeOf(k)&&e.indexOf(Object.getPrototypeOf(k).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(k)):[]).filter((e=>"constructor"!==e&&"function"==typeof k[e]))).forEach((e=>i[e]=i[e].bind(P))),P},modifiedProperty:d,computed:function(e,{autoRun:t=!0,callback:n,bind:r,disableTracking:o=!1}={}){function i(t,i=[]){const u=n||c;o||(u[b]=new WeakMap),y.unshift(u),i=i.length>0?[...i,a]:[a];const f=t?t():r?e.apply(r,i):e(...i);return y.shift(),f}const a={computeAsync:i},c=(...e)=>i(null,e);return t&&c(),c},dispose:function(e){return e[o.trackerSymbol]=null,e.__disposed=!0},batch:c};export{p as default};
//# sourceMappingURL=index.mjs.map
