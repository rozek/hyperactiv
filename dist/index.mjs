const e=["String","Number","Object","Array","Boolean","Date"];function t(e){return e&&"object"==typeof e}function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,configurable:!0})}function r(e,t,r){n(e,"__key",t),n(e,"__parent",r)}const o={computedStack:[],trackerSymbol:Symbol("tracker")};let c=null;const u=Symbol();function a(){if(c){for(const e of c)e(),e[u]=!1;c=null}}function i(e,t){e[u]||(null===c&&(c=[],!0===t?queueMicrotask(a):setTimeout(a,t)),c.push(e))}const{computedStack:l,trackerSymbol:f}=o,s=Symbol("__observed");function b(e,t,n){if(e===t)return!1;let r=typeof e;if(r!==typeof t)return!0;switch(r){case"undefined":case"boolean":case"string":case"function":default:return!0;case"number":return isNaN(e)!==isNaN(t)||Math.abs(e-t)>Number.EPSILON;case"object":return null==e||(null==t||("by-value"===n&&(e instanceof Boolean||e instanceof Number||e instanceof String)?e.valueOf()!==t.valueOf():Array.isArray(e)?function(e,t,n){if(!Array.isArray(t))return!0;if(e.length!==t.length)return!0;for(let r=0,o=e.length;r<o;r++)if(b(e[r],t[r],n))return!0;return!1}(e,t,n):"by-reference"===n||function(e,t,n){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!0;for(let n in e)if(!(n in t))return!0;for(let r in t){if(!(r in e))return!0;if(b(e[r],t[r],n))return!0}return!1}(e,t,n)))}return!0}const{computedStack:y,trackerSymbol:d}=o;var p={observe:function o(c,a={}){const{props:y,ignore:d,batch:p,deep:_=!0,bubble:g,bind:h}=a;if(c[s])return c;const m=e=>e!==s&&(null==y||y instanceof Array&&y.includes(e))&&(null==d||d instanceof Array&&!d.includes(e));_&&Object.entries(c).forEach((function([e,n]){t(n)&&m(e)&&(c[e]=o(n,a),g&&r(c[e],e,c))}));const O=new Map,k=new Proxy(c,{get(e,t){if(t===s)return!0;if(m(t)&&l.length){const e=l[0],n=e[f];if(n){let e=n.get(c);e||(e=new Set,n.set(c,e)),e.add(t)}let r=O.get(t);r||(r=new Set,O.set(t,r)),r.add(e)}return c[t]},set(e,s,y){if("__handler"===s)n(c,"__handler",y);else if(m(s)){if(Array.isArray(c)&&"length"===s||b(c[s],y)){const e=_&&t(y),n=c[s];c[s]=e?o(y,a):y,e&&g&&r(c[s],s,c);const b=[s];let d=c;for(;d&&(!d.__handler||!1!==d.__handler(b,y,n,k));)d.__key&&d.__parent?(b.unshift(d.__key),d=d.__parent):d=null;const h=O.get(s);if(h)for(const e of h){const t=e[f],n=t&&t.get(c),r=n&&n.has(s);e.__disposed||t&&!r?h.delete(e):e!==l[0]&&(void 0!==p&&!1!==p?(i(e,p),e[u]=!0):e())}}}else c[s]=y;return!0},defineProperty(e,t,n){if("__handler"===t)throw new Error("Don't track bubble handlers");return m(t)?(!Array.isArray(c)||"length"===t)&&("value"in n&&((n={...n}).value=o(n.value,a)),Reflect.defineProperty(c,t,n)):Reflect.defineProperty(c,t,n)},deleteProperty:(e,t)=>(t in c&&(c[t]=void 0),Reflect.deleteProperty(e,t))});var P;return h&&(P=c,Object.getOwnPropertyNames(P).concat(Object.getPrototypeOf(P)&&e.indexOf(Object.getPrototypeOf(P).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(P)):[]).filter((e=>"constructor"!==e&&"function"==typeof P[e]))).forEach((e=>c[e]=c[e].bind(k))),k},computed:function(e,{autoRun:t=!0,callback:n,bind:r,disableTracking:o=!1}={}){function c(t,c=[]){const i=n||a;o||(i[d]=new WeakMap),y.unshift(i),c=c.length>0?[...c,u]:[u];const l=t?t():r?e.apply(r,c):e(...c);return y.shift(),l}const u={computeAsync:c},a=(...e)=>c(null,e);return t&&a(),a},dispose:function(e){return e[o.trackerSymbol]=null,e.__disposed=!0},batch:a};export{p as default};
//# sourceMappingURL=index.mjs.map
